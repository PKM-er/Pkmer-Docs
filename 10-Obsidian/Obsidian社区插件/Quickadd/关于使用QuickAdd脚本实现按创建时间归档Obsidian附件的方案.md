---
uid: 20240613090057
title: å…³äºä½¿ç”¨ QuickAdd è„šæœ¬å®ç°æŒ‰åˆ›å»ºæ—¶é—´å½’æ¡£ Obsidian é™„ä»¶çš„æ–¹æ¡ˆ
tags: [é™„ä»¶ç®¡ç†, quickaddè„šæœ¬]
description: ä½¿ç”¨ QuickAdd è„šæœ¬å®ç°æŒ‰åˆ›å»ºæ—¶é—´å½’æ¡£ Obsidian é™„ä»¶çš„æ–¹æ¡ˆ
author: ç†ŠçŒ«åˆ«ç†¬å¤œ
type: other
draft: false
editable: false
modified: 20240613090509
---

# å…³äºä½¿ç”¨ QuickAdd è„šæœ¬å®ç°æŒ‰åˆ›å»ºæ—¶é—´å½’æ¡£ Obsidian é™„ä»¶çš„æ–¹æ¡ˆ

> [!caution] å®éªŒæ€§è„šæœ¬ï¼Œå¯¹åº“çš„å˜åŠ¨è¾ƒå¤§ï¼Œè°¨æ…ä½¿ç”¨ï¼Œæ—¨åœ¨ä¸ºæœ‰è¯¥éœ€æ±‚çš„äººæä¾›æ–¹æ³•


Obsidian çš„é™„ä»¶ç®¡ç†ä¸€ç›´æ˜¯ä¸ªéš¾é¢˜ã€‚æˆ‘ç›®å‰é‡‡ç”¨æŒ‡å®šçš„é™„ä»¶æ–‡ä»¶å¤¹æ¥ç®¡ç†é™„ä»¶ï¼Œå¹¶å°½å¯èƒ½ç®€çŸ­åœ°ä½¿ç”¨ WIKI é“¾æ¥ã€‚ç„¶è€Œï¼Œä¸€ä¸ªæ–‡ä»¶å¤¹é‡Œå·²ç»æœ‰ä¸ƒåƒå¤šå¼ å›¾ç‰‡ï¼Œæ¯æ¬¡æ‰“å¼€éƒ½ä»¤äººå¤´ç–¼ã€‚

![2024-06-13_055036 å…³äºä½¿ç”¨QuickAddè„šæœ¬å®ç°æŒ‰åˆ›å»ºæ—¶é—´å½’æ¡£Obsidiané™„ä»¶çš„æ–¹æ¡ˆ](https://cdn.pkmer.cn/images/202406131002626.png!pkmer)

æˆ‘è€ƒè™‘é‡‡ç”¨ PKMer ç¾¤å‹ä¹‹å‰è®¨è®ºçš„ï¼ŒæŒ‰ç…§ `YYYY/YYYY-MM-DD` çš„æ–¹å¼å½’æ¡£é™„ä»¶ã€‚ä½†åœ¨ Obsidian çš„æ’ä»¶å¸‚åœºä¸­ï¼Œä¼¼ä¹æ²¡æœ‰ç›´æ¥è¿™ä¸ªæ–¹æ³•çš„é™„ä»¶ç®¡ç†æ’ä»¶ã€‚å› æ­¤ï¼Œæˆ‘å°è¯•ä½¿ç”¨ QuickAdd è„šæœ¬ï¼Œä»¥é™„ä»¶çš„åˆ›å»ºæ—¶é—´ä¸ºåŸºç¡€ï¼Œè¿›è¡Œæ–‡ä»¶å¤¹åˆ†ç±»å½’æ¡£ï¼Œè°ƒç”¨çš„æ˜¯ Obsidian è‡ªå¸¦çš„ API è¿›è¡Œæ–‡ä»¶ç§»åŠ¨ï¼Œè¿™æ ·ï¼Œé™„ä»¶é“¾æ¥ä¼šè‡ªåŠ¨æ›´æ–°ã€‚å®ç°æ•ˆæœå¦‚ä¸‹ï¼š

![2024-06-13_055036 å…³äºä½¿ç”¨QuickAddè„šæœ¬å®ç°æŒ‰åˆ›å»ºæ—¶é—´å½’æ¡£Obsidiané™„ä»¶çš„æ–¹æ¡ˆ](https://cdn.pkmer.cn/images/202406131002190.gif!pkmer)

è„šæœ¬çš„é…ç½®é€‰é¡¹ï¼š

![2024-06-13_055036 å…³äºä½¿ç”¨QuickAddè„šæœ¬å®ç°æŒ‰åˆ›å»ºæ—¶é—´å½’æ¡£Obsidiané™„ä»¶çš„æ–¹æ¡ˆ](https://cdn.pkmer.cn/images/202406131002660.png!pkmer)

- **è‡ªå®šä¹‰æ–‡ä»¶å¤¹**ï¼šä¸ºç©ºåˆ™ä¸º Obsidian é»˜è®¤è®¾ç½®ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰è·¯å¾„
	- PS: é’ˆå¯¹è¯¥æ–‡ä»¶å¤¹è·¯å¾„ä¸‹ (ä¸åŒ…å«å­æ–‡ä»¶å¤¹) çš„ç¬¦åˆ**æ–‡ä»¶ç±»å‹ (file type)**çš„æ–‡ä»¶è¿›è¡Œå½’æ¡£ã€‚
- **å½’æ¡£æ—¥æœŸæ ¼å¼**ï¼š`YYYY/YYYY-MM-DD`ï¼Œå¯ä»¥é¢„è§ˆ
	- ![2024-06-13_055036 å…³äºä½¿ç”¨QuickAddè„šæœ¬å®ç°æŒ‰åˆ›å»ºæ—¶é—´å½’æ¡£Obsidiané™„ä»¶çš„æ–¹æ¡ˆ](https://cdn.pkmer.cn/images/202406131002984.png!pkmer)
- **æ–‡ä»¶ç±»å‹**ï¼šé»˜è®¤ä¸ºï¼š`png|jpe?g|webp|mp[3,4]|pdf`
	- æ–‡ä»¶åç¼€ç±»å‹ï¼Œä¸åŒç±»å‹ç”¨|åˆ†éš”ï¼Œä¸åŒºåˆ†å¤§å°å†™ã€‚
- **è‡ªå¯åŠ¨è®¾ç½®**ï¼šå¯ä»¥åœ¨ QuickAdd çš„ Macro Manager è®¾ç½®è‡ªå¯åŠ¨ã€‚
	- ![2024-06-13_055036 å…³äºä½¿ç”¨QuickAddè„šæœ¬å®ç°æŒ‰åˆ›å»ºæ—¶é—´å½’æ¡£Obsidiané™„ä»¶çš„æ–¹æ¡ˆ](https://cdn.pkmer.cn/images/202406131002367.png!pkmer)

## QuickAdd Macro è„šæœ¬

è„šæœ¬é…ç½®æµç¨‹ï¼š

![2024-06-13_055036 å…³äºä½¿ç”¨QuickAddè„šæœ¬å®ç°æŒ‰åˆ›å»ºæ—¶é—´å½’æ¡£Obsidiané™„ä»¶çš„æ–¹æ¡ˆ](https://cdn.pkmer.cn/images/202406131002864.png!pkmer)

```js
module.exports = {
  entry: async (QuickAdd, settings, params) => {
    // è·å–é»˜è®¤é…ç½®
    const fs = require('fs');
    const path = require('path');
    // è·å–åº“çš„åŸºæœ¬è·¯å¾„
    const basePath = (app.vault.adapter).getBasePath();

    // æ—¥æœŸæ ¼å¼
    const dateFormat = settings["å½’æ¡£æ—¥æœŸæ ¼å¼(date format)"].replace("{{DATE:", "").replace("}}", "");

    // è·å–è®¾ç½®çš„æŒ‡å®šé™„ä»¶æ–‡ä»¶å¤¹è·¯å¾„ï¼š
    // const assetsPath = "900ã€ç´ æã€‘Assets/910_ObsidianAssets";
    let assetsPath = app.vault.config.attachmentFolderPath;
    if (settings["è‡ªå®šä¹‰æ–‡ä»¶å¤¹(custom folder path)"]) {
      assetsPath = settings["è‡ªå®šä¹‰æ–‡ä»¶å¤¹(custom folder path)"];
    }

    const assetsPathFull = basePath + "/" + assetsPath;
    console.log(assetsPathFull);

    // è·å–è¯¥è·¯å¾„ä¸‹æ‰€æœ‰é™„ä»¶ï¼š
    const assetsList = fs.readdirSync(assetsPathFull).filter(file => {
      const ext = path.extname(file).toLowerCase();
      // ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥åŒ¹é…æ–‡ä»¶æ‰©å±•åï¼š
      // å¦‚æœ settings["æ–‡ä»¶ç±»å‹(Custom folder path)"] ä¸ºç©ºå€¼ï¼Œåˆ™åŒ¹é…æ‰€æœ‰æ–‡ä»¶ç±»å‹
      const regexMatch = new RegExp("\\.(" + (settings["æ–‡ä»¶ç±»å‹(Custom folder path)"] || ".+") + ")$", "i");
      return regexMatch.test(ext);
    }).map(file => assetsPath + "/" + file);

    console.log(assetsList);

    // æ‰¹é‡è·å–åˆ›å»ºæ—¥æœŸå¹¶ç”¨obçš„APIç§»åŠ¨é™„ä»¶
    assetsList.forEach(async (filePath) => {
      const ctime = app.vault.getAbstractFileByPath(filePath).stat["ctime"];
      // const ctime = fs.statSync(filePath).ctime;
      const formattedDatePath = assetsPath + "/" + moment(ctime).format(dateFormat);
      console.log(formattedDatePath);
      if (!app.vault.getFolderByPath(formattedDatePath)) {
        app.vault.createFolder(formattedDatePath);
      }

      // ç§»åŠ¨é™„ä»¶
      const destinationPath = path.join(formattedDatePath, path.basename(filePath));
      await app.fileManager.renameFile(app.vault.getAbstractFileByPath(filePath), destinationPath);

    });
    new Notice(`ğŸ”Š${assetsList.length}ä¸ªé™„ä»¶å½’æ¡£å·²å®Œæˆ`);
  },
  settings: {
    name: "æŒ‰åˆ›å»ºæ—¶é—´å½’æ¡£Obsidiané™„ä»¶",
    author: "ç†ŠçŒ«åˆ«ç†¬å¤œ",
    options: {
      "è‡ªå®šä¹‰æ–‡ä»¶å¤¹è·¯å¾„(custom folder path)": {
        type: "text",
        defaultValue: "",
        description: "å¦‚æœä¸ºç©ºåˆ™ä¸ºObsidiané»˜è®¤é™„ä»¶å­˜æ”¾è·¯å¾„"
      },
      "å½’æ¡£æ—¥æœŸæ ¼å¼(date format)": {
        type: "format",
        defaultValue: "{{DATE:YYYY/YYYY-MM/YYYY-MM-DD}}",
        description: "å¦‚æœæƒ³ä»¥æ–‡ä»¶ç±»å‹åˆ†ç±»ï¼Œå¯ä»¥é…ç½®{{DATE:[å›¾å½¢æ–‡ä»¶]YYYY/YYYY-MM-DD}}ã€{{DATE:[è§†é¢‘æ–‡ä»¶]YYYY/YYYY-MM-DD}}",
      },
      "æ–‡ä»¶ç±»å‹(file type)": {
        type: "text",
        defaultValue: "png|jpe?g|webp|gif|mp[34]|pdf",
        description: "æ–‡ä»¶åç¼€ç±»å‹ï¼Œä¸åŒç±»å‹ç”¨|åˆ†éš”ï¼Œä¸åŒºåˆ†å¤§å°å†™ï¼Œå¦‚æœä¸ºç©ºå€¼åˆ™é»˜è®¤å…¨éƒ¨é™„ä»¶ã€‚"
      }
    }
  }
};
```

## æ‹“å±•æ–¹æ³•ï¼šPython é™„ä»¶å½’æ¡£

ä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒQuickAdd çš„æ–¹æ³•ä¸€æ¬¡æ€§åªèƒ½å¤„ç†å°‘é‡é™„ä»¶ï¼Œè¦å¤„ç†å¤§é‡é™„ä»¶çš„è¯å¯èƒ½ä¼šéœ€è¦ç”¨å¾ˆé•¿æ—¶é—´ï¼Œé™¤äº†ä½¿ç”¨ QuickAdd ä¹‹å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡ Python è„šæœ¬å®ç°é™„ä»¶å½’æ¡£ã€‚ä½†è¯¥æ–¹å¼æ˜¯åœ¨åº“å¤–ç§»åŠ¨æ–‡ä»¶ä½ç½®ï¼Œè¿™æ ·ä¼šå¯¼è‡´é“¾æ¥å¤±æ•ˆã€‚å¦‚æœæ‚¨çš„åº“å…¨éƒ¨ä½¿ç”¨çš„æ˜¯ç®€çŸ­çš„ WIKI é“¾æ¥æ ¼å¼ï¼Œè¿™ç§æ–¹æ³•å¯ä»¥åˆæ­¥æ›´å¿«åœ°è¿›è¡Œå½’æ¡£ï¼Œåœ¨ä¿®æ”¹åé‡å¯ Obsidian å°±èƒ½ä¿®å¤ï¼Œä¹‹åå¯ä»¥é‡‡ç”¨ç¬¬ä¸€ç§æ–¹æ³•ã€‚

> [!caution] Python è„šæœ¬æ˜¯åº“å¤–ç§»åŠ¨æ–‡ä»¶ï¼Œä¼šå¯¼è‡´é“¾æ¥å¤±æ•ˆï¼Œä¸æ¨èä½¿ç”¨

ä¿å­˜ä¸º `00_ObsidianAssets.py` å­˜æ”¾åœ¨ Obsidian é»˜è®¤é™„ä»¶æ–‡ä»¶å¤¹ã€‚

```Python
import os
import shutil
from datetime import datetime

# è·å–å½“å‰æ–‡ä»¶å¤¹è·¯å¾„
current_dir = os.getcwd()

# éå†å½“å‰æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰æ–‡ä»¶
for file_name in os.listdir(current_dir):
    if file_name.lower().endswith(('.jpg', '.jpeg', '.png', '.pdf')):
        file_path = os.path.join(current_dir, file_name)
        # è·å–æ–‡ä»¶çš„åˆ›å»ºæ—¥æœŸ
        create_time = datetime.fromtimestamp(os.path.getctime(file_path))
        folder_name = create_time.strftime('%Y/%Y-%m/%Y-%m-%d')
        folder_path = os.path.join(current_dir, folder_name)

        # åˆ›å»ºæ–‡ä»¶å¤¹
        os.makedirs(folder_path, exist_ok=True)

        # ç§»åŠ¨æ–‡ä»¶åˆ°å¯¹åº”çš„æ–‡ä»¶å¤¹
        shutil.move(file_path, os.path.join(folder_path, file_name))

```

å¯ä»¥è®¾ç½® `.bat` è¿›è¡Œè¿è¡Œï¼š

```cmd
@echo off
python "%cd%\00_ObsidianAssets.py"
exit
```