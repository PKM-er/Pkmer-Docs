---
uid: 20240106235941
title: QuickAdd è„šæœ¬ - ä¿®å¤ Canvas ä¸­çš„å¤±æ•ˆæ–‡æ¡£çš„é“¾æ¥
tags: [Canvas, quickaddè„šæœ¬]
description: é’ˆå¯¹ Canvas ä¸­å¤§é‡å¤±æ•ˆçš„ç¬”è®°æˆ–æ–‡ä»¶è¿›è¡Œä¿®å¤çš„è„šæœ¬ï¼Œå€Ÿç”¨ Quickadd çš„ Capture è¿›è¡Œè¿è¡Œã€‚
author: ç†ŠçŒ«åˆ«ç†¬å¤œ,calmwaves
type: other
draft: false
editable: false
modified: 20240107000410
---

# QuickAdd è„šæœ¬ - ä¿®å¤ Canvas ä¸­çš„å¤±æ•ˆæ–‡æ¡£çš„é“¾æ¥

é’ˆå¯¹ Canvas ä¸­å¤§é‡å¤±æ•ˆçš„ç¬”è®°æˆ–æ–‡ä»¶è¿›è¡Œä¿®å¤çš„è„šæœ¬ï¼Œå€Ÿç”¨ Quickadd çš„ Capture è¿›è¡Œè¿è¡Œã€‚

![QuickAdd è„šæœ¬ - ä¿®å¤ Canvas ä¸­çš„å¤±æ•ˆæ–‡æ¡£çš„é“¾æ¥](https://cdn.pkmer.cn/images/202401070003406.gif!pkmer)

## èƒŒæ™¯

æˆ‘ä¸€èˆ¬é‡‡ç”¨ Obsidian çš„å°½å¯èƒ½ç®€çŸ­å½¢å¼çš„ Wiki çš„é“¾æ¥å½¢å¼ï¼Œè¿™æ · Obsidian é‡Œé¢çš„ç¬”è®°é“¾æ¥ä¸å®¹æ˜“å¤±æ•ˆï¼š

![QuickAdd è„šæœ¬ - ä¿®å¤ Canvas ä¸­çš„å¤±æ•ˆæ–‡æ¡£çš„é“¾æ¥](https://cdn.pkmer.cn/images/202401070003407.png!pkmer)

**Canvas ä¸­ç¬”è®°å¤±æ•ˆçš„åŸå› **ï¼šå› ä¸ºæˆ‘å¯¹ Obsidian çš„æ–‡ä»¶å¤¹åˆ—è¡¨æ“ä½œå®åœ¨ä¸æ„Ÿå†’ï¼Œæ‰€ä»¥ç»å¸¸ä¼šåœ¨ç³»ç»Ÿçš„**èµ„æºç®¡ç†å™¨**ä¸­å¯¹ `æ–‡ä»¶å¤¹` å’Œ `ç¬”è®°` è¿›è¡Œä¸€å®šä¿®æ”¹ç§»åŠ¨ (PSï¼šåƒä¸‡ä¸è¦æ›´æ”¹ md çš„åç§°ï¼Œä¸ç„¶ä½ ä¼šåæ‚”çš„)ï¼Œ==è™½ç„¶ `ç®€çŸ­çš„ Wiki é“¾æ¥` ä¼šä¿æŒ md ç¬”è®°é—´çš„è”ç³»ä¸ä¼šå¤±æ•ˆï¼Œä½†æ˜¯ Canvas åˆ™ä¼šç›´æ¥å¤±æ•ˆï¼Œå› ä¸º Canvas é‡Œé¢é‡‡ç”¨çš„æ˜¯åŸºäº Obsidian åº“çš„ç›¸å¯¹è·¯å¾„ï¼Œè€Œä¸æ”¯æŒ Wiki é“¾æ¥ã€‚==

![QuickAdd è„šæœ¬ - ä¿®å¤ Canvas ä¸­çš„å¤±æ•ˆæ–‡æ¡£çš„é“¾æ¥](https://cdn.pkmer.cn/images/202401070003408.png!pkmer)

æ‰€ä»¥æœ‰ä¸€æ¬¡æˆ‘ä»**èµ„æºç®¡ç†å™¨**è¿›è¡Œä¸€ç•ªæ“ä½œåï¼Œå‘ç° Canvas ä¸­å¤§é‡çš„ç¬”è®°å¤±æ•ˆï¼Œä¹Ÿæ²¡æœ‰å¤‡ä»½è®°å½•ï¼Œèƒ½ä¿®å¤çš„æ–¹æ³•åªæœ‰æ‰‹åŠ¨æ“ä½œï¼Œä½†ä¸€ä¸ª Canvas ä¸­æœ‰å‡ åç”šè‡³ä¸Šç™¾ä¸ªå°å¡ç‰‡ç¬”è®°ï¼Œä¸ºäº†èŠ‚çœæ—¶é—´ï¼Œå†™äº†è¿™ä¸ªä¿®å¤ Canvas å¤±æ•ˆçš„ç¬”è®°æˆ–è€…æ–‡ä»¶çš„è„šæœ¬ã€‚

## Quickadd çš„è„šæœ¬é…ç½®

> [!caution] è„šæœ¬è¿è¡Œçš„æ³¨æ„äº‹é¡¹
> 1. Canvas ä¸­çš„ç¬”è®°ä¸è¦æœ‰ç›¸åŒæ–‡ä»¶åçš„å…¶ä»–ç¬”è®°å­˜åœ¨ï¼Œå¦‚æœæœ‰åˆ™è¯¥è„šæœ¬ä¼šè·³è¿‡ä¿®å¤ã€‚
> 	1. [[#Tipï¼šDataViewJS- æ£€æµ‹åº“å†…é‡å¤æ–‡ä»¶åçš„ç¬”è®°]]
> 2. è„šæœ¬åªæ˜¯ä»æ–‡ä»¶åˆ—è¡¨æ€§è´¨ä¸Šçš„æ£€ç´¢ï¼Œæ‰€ä»¥ä¼šå¯¹ Canvas ä¸­çš„æ‰€æœ‰ç¬”è®°è¿›è¡Œæ£€æµ‹ï¼Œå¦‚æœä½ å‘ç°è„šæœ¬è¿è¡Œåå‡ºç°ç‰¹åˆ«å¤šçš„æ”¹å˜ï¼Œè¯·é€šè¿‡ `Ctrl + Z` é€€å›ã€‚

### æ·»åŠ  Quickadd çš„ Capture é€‰é¡¹

![QuickAdd è„šæœ¬ - ä¿®å¤ Canvas ä¸­çš„å¤±æ•ˆæ–‡æ¡£çš„é“¾æ¥](https://cdn.pkmer.cn/images/202401070003409.png!pkmer)

### Captureï¼šâ™»FixCanvas çš„é…ç½®

![QuickAdd è„šæœ¬ - ä¿®å¤ Canvas ä¸­çš„å¤±æ•ˆæ–‡æ¡£çš„é“¾æ¥](https://cdn.pkmer.cn/images/202401070003410.png!pkmer)

### Captureï¼šâ™»FixCanvas çš„è„šæœ¬

````md
```js quickadd
const path = require('path');
const fs = require('fs');

// è·å–ç¬”è®°çš„åŸºæœ¬è·¯å¾„
const file = app.workspace.getActiveFile();
const fileFullPath = app.vault.adapter.getFullPath(file.path);
const isFixCanvasFileLink = confirm(`æ˜¯å¦å¼ºåˆ¶ä¿®å¤\n${fileFullPath}\nçš„å†…éƒ¨æ–‡ä»¶é“¾æ¥`);
if (isFixCanvasFileLink && file.extension == 'canvas') {
    new Notice('ğŸ”´ä¿®å¤ Canvas ä¸­å¤±æ•ˆçš„æ–‡ä»¶');

    // è·å–åº“æ‰€æœ‰æ–‡ä»¶åˆ—è¡¨
    const files = app.vault.getFiles();
    // wikiPath = getFilePath(files, selectionEmbed); // åŒ¹é…Wikié“¾æ¥
    // console.log(wikiPath);

    // è¯»å–JSONæ ¼å¼çš„canvasæ–‡ä»¶å¹¶ä¿®æ”¹nodesä¸­çš„object.fileåå†å†™å›åŸæ–‡ä»¶
    fs.readFile(fileFullPath, 'utf8', (err, data) => {
        if (err) throw err;
        const canvasData = JSON.parse(data);

        // å¤„ç†nodesä¸­çš„object.fileï¼Œä¾‹å¦‚å°†å…¶æ›¿æ¢ä¸ºå…¶ä»–æ–‡ä»¶
        canvasData.nodes.forEach(node => {
            // è¿›è¡Œå¤„ç†ï¼Œä¾‹å¦‚æ›¿æ¢ä¸ºå…¶ä»–æ–‡ä»¶
            const baseName = path.basename(String(node.file));
            const filePath = getFilePath(files, baseName);

            if ((filePath.length > 1 || !filePath) && (baseName.length > 1)) {
                new Notice(`ğŸŸ¡æ–‡ä»¶ï¼š${baseName}ï¼Œæœ‰${filePath.length}ä¸ªé‡å¤æ–‡ä»¶ï¼Œå› æ­¤è·³è¿‡ä¿®å¤`, 5000);

            } else if (baseName.length > 1) {
                node.file = String(filePath);
            }

        });
        // å°†ä¿®æ”¹åçš„canvasDataå†™å›åŸæ–‡ä»¶
        fs.writeFile(fileFullPath, JSON.stringify(canvasData, null, 2), 'utf8', (err) => {
            if (err) throw err;
            new Notice('ğŸŸ¢Canvaså¤±æ•ˆæ–‡æ¡£å·²æ›´æ–°');
        });
    });

}

function getFilePath(files, baseName) {
    let files2 = files.filter(f => path.basename(f.path) === baseName);
    let filePath = files2.map((f) => f.path);
    console.log(filePath);
    return filePath;
}
```
````

## Tipï¼šDataViewJS- æ£€æµ‹åº“å†…é‡å¤æ–‡ä»¶åçš„ç¬”è®°

è¯¥ DataViewJS ç‰‡æ®µç”± @Calmwaves æä¾›ã€‚

![QuickAdd è„šæœ¬ - ä¿®å¤ Canvas ä¸­çš„å¤±æ•ˆæ–‡æ¡£çš„é“¾æ¥](https://cdn.pkmer.cn/images/202401070003411.png!pkmer)

````md
```dataviewjs
// å‡è®¾æ‚¨çš„å¯¹è±¡æ•°ç»„ä¸º data
const data = dv.pages();

let countMap = {}; // ç”¨äºå­˜å‚¨è®¡æ•°çš„å¯¹è±¡
let duplicates = []; // ç”¨äºå­˜å‚¨é‡å¤å…ƒç´ çš„æ•°ç»„

// éå†å¯¹è±¡æ•°ç»„
data.forEach((element) => {
  let fileName = element.file.name;
  let filePath = element.file.path;

  // è®¡æ•°
  if (countMap[fileName]) {
    countMap[fileName].count++;
    countMap[fileName].paths.push(filePath);
  } else {
    countMap[fileName] = { count: 1, paths: [filePath] };
  }
});

let dup=0//è¿™æ˜¯å‘ç°äº†å‡ ä¸ªdupçš„name
let flag =0//æœ‰é‡åæ–‡ä»¶çš„æ ‡å¿—
for (const key in countMap) {
    const element = countMap[key];
    if (element.count > 1) {
      dup++;
      if(dup>0&&flag==0){dv.paragraph("==æœ‰é‡åæ–‡ä»¶==");flag=1}
      dv.span(`ã€Š${key}.mdã€‹å‡ºç°äº†${element.count}æ¬¡`);
      const pathstolink = element.paths.map(path => `[[${path}]]`);
      dv.list(pathstolink);

    }
}
if(dup==0){
dv.span("æ²¡æœ‰é‡åæ–‡ä»¶")
}
```
````
