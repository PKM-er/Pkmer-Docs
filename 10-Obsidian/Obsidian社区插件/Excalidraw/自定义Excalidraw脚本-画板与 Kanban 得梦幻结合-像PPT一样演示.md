---
uid: 20240122215722
title: è‡ªå®šä¹‰ Excalidraw è„šæœ¬ - ç”»æ¿ä¸ Kanban å¾—æ¢¦å¹»ç»“åˆ - åƒ PPT ä¸€æ ·æ¼”ç¤º
tags: [Excalidrawè„šæœ¬, Kanban, PPT]
description: "å€Ÿç”¨ Obsidian çš„ Kanban æ’ä»¶ çš„ UI åŠŸèƒ½ï¼Œå®ç°ä¸€ä¸ª Excalidraw çš„ç®€å•çš„å¤§çº²ã€‚\r\rå€Ÿç”¨ Kanban çš„æ‹–æ‹½åŠŸèƒ½å¯ä»¥æŒ‰ç…§ Kanban çš„è‡ªä¸Šè€Œä¸‹çš„é¡ºåºå¯¹ Frame è¿›è¡Œæ’åºï¼ŒåŒæ—¶ç”¨å¤§å”çš„ SildeShow è„šæœ¬æ¼”ç¤ºç”»å¸ƒï¼Œå®ç°åƒ PPT ä¸€æ ·çš„æ¼”ç¤ºã€‚"
author: ç†ŠçŒ«åˆ«ç†¬å¤œ
type: other
draft: false
editable: false
modified: 20240122223401
---

# è‡ªå®šä¹‰ Excalidraw è„šæœ¬ - ç”»æ¿ä¸ Kanban å¾—æ¢¦å¹»ç»“åˆ - åƒ PPT ä¸€æ ·æ¼”ç¤º

![è‡ªå®šä¹‰ Excalidraw è„šæœ¬ - ç”»æ¿ä¸ Kanban å¾—æ¢¦å¹»ç»“åˆ - åƒ PPT ä¸€æ ·æ¼”ç¤º](https://cdn.pkmer.cn/images/202401222205477.png!pkmer)

## å‰è¨€ç®€ä»‹

**å€Ÿç”¨ Obsidian çš„ [[obsidian-kanban|Kanban æ’ä»¶]] çš„ UI åŠŸèƒ½**ï¼Œé…åˆ Excalidraw çš„ ` Frame æ¡†æ¶` ä»¥åŠ [[Excalidrawå±€éƒ¨åµŒå…¥Obsidian|å±€éƒ¨å¼•ç”¨åŠŸèƒ½]] ç”Ÿæˆä¸€ä¸ª `FrameKanban.md` æ–‡ä»¶ï¼Œè¯¥ FrameKanban.md æ–‡ä»¶å…¶å®æ˜¯ä¸€ä¸ªåŠ¨æ€æ–‡ä»¶ï¼Œä¼šæ ¹æ®å½“å‰çš„ Excalidraw è€Œç”Ÿæˆå¯¹åº”çš„ç¼©ç•¥å›¾æˆ–è€…æ ‡é¢˜å¤§çº²ï¼Œå®ç°ä¸€ä¸ª Excalidraw çš„ç®€å•çš„å¤§çº²ã€‚

![è‡ªå®šä¹‰ Excalidraw è„šæœ¬ - ç”»æ¿ä¸ Kanban å¾—æ¢¦å¹»ç»“åˆ - åƒ PPT ä¸€æ ·æ¼”ç¤º](https://cdn.pkmer.cn/images/202401222205478.gif!pkmer)

**å€Ÿç”¨ Kanban çš„æ‹–æ‹½åŠŸèƒ½**å¯ä»¥æŒ‰ç…§ Kanban çš„è‡ªä¸Šè€Œä¸‹çš„é¡ºåºå¯¹ Frame è¿›è¡Œæ’åºï¼Œç„¶åä½ å¯ä»¥ç”¨è¯¥è„šæœ¬å¯¹ Excalidraw çš„ Frame è¿›è¡Œæ’åºã€‚åŒæ—¶ç”¨å¤§å”çš„ [[Excalidrawè„šæœ¬-Slideshowå®Œç¾å®ç°ç”»æ¿å¹»ç¯ç‰‡æ¼”ç¤ºçš„è„šæœ¬|SildeShow]] è„šæœ¬æ¼”ç¤ºç”»å¸ƒï¼Œå®ç°åƒ PPT ä¸€æ ·çš„æ¼”ç¤ºã€‚

![è‡ªå®šä¹‰ Excalidraw è„šæœ¬ - ç”»æ¿ä¸ Kanban å¾—æ¢¦å¹»ç»“åˆ - åƒ PPT ä¸€æ ·æ¼”ç¤º](https://cdn.pkmer.cn/images/202401222205479.gif!pkmer)

> [!tip] Frame çš„å‘½å
> æ­£å¸¸çš„ Fame å‘½åç¨å¾®æœ‰ç‚¹ä¸æ–¹ä¾¿ (ä»…ä¸ªäººæ„Ÿè§‰ï¼Œå¯èƒ½å¤§å”ä¹‹åä¼šä¼˜åŒ–)ï¼Œæˆ‘ä¹‹å‰å†™è¿‡ [[è‡ªå®šä¹‰Excalidrawè„šæœ¬-OCRè‡ªåŠ¨æå–å›¾ç‰‡æ–‡å­—|TextExtractor]] çš„ä¸€ä¸ªè„šæœ¬ï¼Œæ˜¯ç”¨äºå¯¹å›¾ç‰‡è¿›è¡Œ OCR çš„ï¼Œå…¶å®è¿˜å¯ä»¥å¯¹ Frame æˆ–è€… Text çš„å…ƒç´ è¿›è¡Œç¼–è¾‘ï¼Œä¹Ÿå°±æ˜¯ä¸ä»…å¯ä»¥ç¼–è¾‘å›¾å½¢æ–‡æœ¬è¿˜æ˜¯å¯¹ Frame å’ŒåŒ…å«æ–‡æœ¬å…ƒç´ è¿›è¡Œæ–‡æœ¬ç¼–è¾‘ã€‚
> ![è‡ªå®šä¹‰ Excalidraw è„šæœ¬ - ç”»æ¿ä¸ Kanban å¾—æ¢¦å¹»ç»“åˆ - åƒ PPT ä¸€æ ·æ¼”ç¤º](https://cdn.pkmer.cn/images/202401222205480.gif!pkmer)

## ä½¿ç”¨æ•™ç¨‹

### è§†é¢‘æ•™ç¨‹

<iframe src="https://player.bilibili.com/player.html?aid=496214790&bvid=BV13K411i7Jy&cid=1405753394&p=1" autoplay="false" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" width="100%" height="500"> </iframe>

### ä½¿ç”¨ç”¨æ³•

é¦–å…ˆæ„Ÿè°¢ç¾¤å‹ @é¢œå‡¯ æä¾›äº†ä»¥ä¸‹çš„ä½¿ç”¨æ•™ç¨‹ï¼Œæ¯”æˆ‘å†™çš„å¥½å¤šäº†ï¼Œæˆ‘ä¼°è®¡éƒ½ä¸ä¼šå†™è¿™äº›è¯¦ç»†ï¼Œä»¥åæ³¨æ„å¹¶å­¦ä¹ ä¸€ä¸‹ (by ç†ŠçŒ« 24.01.15)

- å‰ææ¡ä»¶ï¼š
	- 1ã€å®‰è£… kanban è„šæœ¬ï¼ˆæ•™ç¨‹è¯¦è§ï¼š[[Excalidrawå¦‚ä½•å®‰è£…è„šæœ¬_è„šæœ¬è®¾ç½®ä»‹ç»]])
	- 2ã€å®‰è£… kanban æ’ä»¶
- è„šæœ¬è®¾ç½®
	- ![è‡ªå®šä¹‰ Excalidraw è„šæœ¬ - ç”»æ¿ä¸ Kanban å¾—æ¢¦å¹»ç»“åˆ - åƒ PPT ä¸€æ ·æ¼”ç¤º](https://cdn.pkmer.cn/images/202401222205481.png!pkmer)

#### ç¬¬ä¸€æ­¥ï¼šFrame é€‰å®šæ¼”ç¤ºèŒƒå›´

![è‡ªå®šä¹‰ Excalidraw è„šæœ¬ - ç”»æ¿ä¸ Kanban å¾—æ¢¦å¹»ç»“åˆ - åƒ PPT ä¸€æ ·æ¼”ç¤º](https://cdn.pkmer.cn/images/202401222205482.png!pkmer)

#### ç¬¬äºŒæ­¥ï¼šæ‰“å¼€ Kanban æ–‡ä»¶

ä¸€å®šè¦å…ˆæ‰“å¼€ kanban æ–‡ä»¶ï¼Œä¸ç„¶è¿è¡Œè„šæœ¬æ‰¾ä¸åˆ°å¯¹åº”çš„æ˜¾ç¤ºåˆ—è¡¨

![è‡ªå®šä¹‰ Excalidraw è„šæœ¬ - ç”»æ¿ä¸ Kanban å¾—æ¢¦å¹»ç»“åˆ - åƒ PPT ä¸€æ ·æ¼”ç¤º](https://cdn.pkmer.cn/images/202401222205483.png!pkmer)

#### ç¬¬ä¸‰æ­¥ï¼šè¿è¡Œè„šæœ¬åŠŸèƒ½

- è„šæœ¬åŠŸèƒ½ä»‹ç»
	- `true`ï¼šæœ‰ç¼©ç•¥å›¾
	- `false`ï¼šæ— ç¼©ç•¥å›¾
	- `sort`ï¼šæ’åºï¼ˆè°ƒæ•´é¡ºåºåï¼Œå†æŒ‰ `sort`ï¼Œé¡ºåºå®Œæˆæ›´æ–°ï¼‰
	- `open`ï¼šä»¥ 4 ç§æ¨¡å¼ (æ–°æ ‡ç­¾é¡µ `tab`ã€å‚ç›´æ ‡ç­¾é¡µ `vertical`ã€æ°´å¹³æ ‡ç­¾é¡µ `horizontal`ã€æ‚¬æµ®æ ‡ç­¾é¡µ `hover`ï¼Œéœ€è¦å®‰è£… Hover æ’ä»¶) æ‰“å¼€ kanban
		- PSï¼šä¸€èˆ¬å›ºå®šåˆ°ä¾§è¾¹åå°±ä¸éœ€è¦é¢å¤–æ‰“å¼€äº†ã€‚

![è‡ªå®šä¹‰ Excalidraw è„šæœ¬ - ç”»æ¿ä¸ Kanban å¾—æ¢¦å¹»ç»“åˆ - åƒ PPT ä¸€æ ·æ¼”ç¤º](https://cdn.pkmer.cn/images/202401222205485.png!pkmer)

## ä¸è¶³ä¹‹å¤„

1. ä¾èµ–äº kanbanï¼Œä¸è¿‡æ‹–æ‹½åˆ°æ–‡æœ¬ï¼Œåªèƒ½åœ¨çœ‹æ¿ä¹‹é—´ç§»åŠ¨ï¼›
2. ä¸æ”¯æŒåµŒå¥—ï¼Œæ²¡æœ‰å±‚çº§ç®¡ç†ï¼Œæ„Ÿè§‰åŠŸèƒ½å¤ªå¤æ‚äº†ï¼Œåè€Œä¸å¥½ç”¨ï¼Œä¹Ÿä¸æƒ³æŠ˜è…¾äº†ã€‚

## å¸¸è§ BUG

### ç¼©ç•¥å›¾æ²¡æœ‰ç”Ÿæˆæˆ–è€…åˆ·æ–°

Kanban æ–‡ä»¶çš„åˆ·æ–°ç¨å¾®æœ‰ç‚¹å»¶è¿Ÿï¼Œè€Œä¸” Excalidraw çš„å±€éƒ¨å¼•ç”¨è§†å›¾ç”Ÿæˆåœ¨ç¬¬ä¸€æ¬¡æ‰“å¼€æ—¶éœ€è¦ä¸€ç‚¹æ—¶é—´çš„ï¼Œä½ å¯ä»¥ç¨å¾®ç­‰ä¸€ä¼šå„¿ã€‚

> [!tip] Excalidraw çš„åµŒå…¥å›¾ç‰‡è®¾ç½®
> ![è‡ªå®šä¹‰ Excalidraw è„šæœ¬ - ç”»æ¿ä¸ Kanban å¾—æ¢¦å¹»ç»“åˆ - åƒ PPT ä¸€æ ·æ¼”ç¤º](https://cdn.pkmer.cn/images/202401222205486.png!pkmer)
>  **æ¨èæ¨¡å¼ï¼š** å¦‚æœç”µè„‘æ€§èƒ½ä¸€èˆ¬çš„æƒ…å†µä¸‹ï¼Œå»ºè®®åœ¨ç¼–è¾‘æˆ–è€…å¿«é€ŸæŸ¥çœ‹çš„æ—¶å€™é‡‡ç”¨ PNG æ¨¡å¼ï¼Œå½“ä½ éœ€è¦çœŸæ­£çš„å¤åˆ¶æ–‡æœ¬çš„è¯ï¼Œå†å»åˆ‡æ¢ Native SVG æ ¼å¼ï¼Œä¸è¿‡ Kanban çš„å›¾ç‰‡æ˜¯ä¸èƒ½é¢„è§ˆçš„ã€‚

## EA è„šæœ¬

[[Excalidrawå¦‚ä½•å®‰è£…è„šæœ¬_è„šæœ¬è®¾ç½®ä»‹ç»]]

```js
const fs = require('fs');
const activefile = app.workspace.getActiveFile();
let settings = ea.getScriptSettings();
// åŠ è½½é»˜è®¤å€¼
if (!settings["åŠ¨æ€Kanban.mdçš„è·¯å¾„"]) {

    settings = {
        "åŠ¨æ€Kanban.mdçš„è·¯å¾„": {
            value: "Excalidraw/Excalidraw.Kanban.md",
            description: "ç”¨äºå­˜æ”¾Frameçš„Kanbanæ–‡ä»¶çš„å­˜å‚¨è·¯å¾„<br>obçš„è·¯å¾„ï¼Œå¦‚ï¼šExcalidraw/Excalidraw.Kanban.md"
        },
        "Kanbançš„å®½åº¦": {
            value: 340,
            description: "Kanbançš„å®½åº¦ï¼Œé»˜è®¤å€¼ä¸º330"
        },
        "ç¼©ç•¥å›¾æ˜¯å¦å¸¦è¿æ¥": {
            value: false,
            description: "å¦‚å¸¦è¿æ¥ï¼Œåˆ™å•å‡»ç¼©ç•¥å›¾å³å¯è·³è½¬"
        },
    };
    ea.setScriptSettings(settings);
}
const kanbanFilePath = settings["åŠ¨æ€Kanban.mdçš„è·¯å¾„"].value;
const KanbanPath = app.vault.getAbstractFileByPath(kanbanFilePath);
const kanbanFullPath = app.vault.adapter.getFullPath(kanbanFilePath);

const KanbanLaneWidth = settings["Kanbançš„å®½åº¦"].value;

await ea.addElementsToView();
const frameElements = ea.getViewElements().filter(el => el.type === "frame");
const fileName = app.workspace.getActiveFile().name;
const choices = ["ç”ŸæˆFrameå¡ç‰‡(æœ‰ç¼©ç•¥å›¾)", "ç”ŸæˆFrameå¤§çº²(æ— ç¼©ç•¥å›¾)", "å¯¹Frameè¿›è¡Œæ’åº", "æ‰“å¼€Kanbanæ–‡ä»¶"];

const choice = await utils.suggester(choices, choices, "æ˜¯å¦ç”Ÿæˆç¼©ç•¥å›¾æˆ–è€…æ’åº");
if (typeof choice === "undefined") {
    return; // é€€å‡ºå‡½æ•°æˆ–ç¨‹åº
}

// ! openæ‰“å¼€å½¢å¼
if (choice === choices[3]) {

    const choices = ["æ–°æ ‡ç­¾é¡µ", "å‚ç›´æ ‡ç­¾é¡µ", "æ°´å¹³æ ‡ç­¾é¡µ", "æ‚¬æµ®æ ‡ç­¾é¡µï¼Œéœ€è¦å®‰è£…Hoveræ’ä»¶"];
    const choice = await utils.suggester(choices, choices, "æ˜¯å¦ç”Ÿæˆç¼©ç•¥å›¾æˆ–è€…æ’åº");
    if (choice === choices[0]) {
        // app.workspace.activeLeaf.openFile(KanbanFullPath);
        app.workspace.getLeaf("tab").openFile(KanbanPath);
    } else if (choice === choices[1]) {
        app.workspace.getLeaf('split', 'vertical').openFile(KanbanPath);

    } else if (choice === choices[2]) {
        app.workspace.getLeaf('split', 'horizontal').openFile(KanbanPath);

    } else if (choice === choices[3]) {
        let newLeaf = app.plugins.plugins["obsidian-hover-editor"].spawnPopover(undefined, () => this.app.workspace.setActiveLeaf(newLeaf, false, true));
        newLeaf.openFile(KanbanPath);
    }
    return;
}


// ! ä¾æ®çœ‹æ¿(kanban)é¡ºåºæ¥æ’åº
if (choice === choices[2]) {


    const updatedElements = await processFile(frameElements, kanbanFullPath, fileName);

    let markdownFile = app.vault.getAbstractFileByPath(kanbanFilePath);
    if (markdownFile) app.vault.modify(markdownFile, updatedElements.join("\n"));
    new Notice(`â™»FrameKanbanå·²æ’åº`, 3000);

    // ! ç»™aliaesæ·»åŠ æ‰€æœ‰Frameçš„åç§°
    const allFrameElements = ea.getViewElements().filter(el => el.type === "frame");
    await app.fileManager.processFrontMatter(activefile, fm => {
        fm.aliases = [];
        for (el of allFrameElements) {
            fm.aliases.push(el.name);
        }
    });
    await ea.addElementsToView();
    
    return;
}

// ! ç”±Excalidrawçš„Frameç”ŸæˆKanban
let frameLinks = [];
if (frameElements.length >= 1) {
    frameElements.sort((a, b) => {
        // æ ¹æ® fileName è¿›è¡Œæ’åº
        if (a.name < b.name) {
            return -1;
        }
        if (a.name > b.name) {
            return 1;
        }
        return 0;
    });

    for (let el of frameElements) {
        let frameLink;
        if (choice === choices[0]) {
            if (settings["ç¼©ç•¥å›¾æ˜¯å¦å¸¦è¿æ¥"].value) {
                frameLink = `- [ ] [[${fileName}#^frame=${el.id}|${el.name}]]<br>[![[${fileName}#^frame=${el.id}]]](${fileName}#^frame=${el.id})`;
            } else {
                frameLink = `- [ ] [[${fileName}#^frame=${el.id}|${el.name}]]<br>![[${fileName}#^frame=${el.id}]]`;
            }
        } else if (choice === choices[1]) {
            frameLink = `- [ ] [[${fileName}#^frame=${el.id}|${el.name}]]`;
        }
        frameLinks.push(frameLink);
    }
}
const kanbanYaml = "---\n\nkanban-plugin: basic\n\n---\n\n";

const kanbanSetting = {
    "kanban-plugin": "basic",
    "lane-width": KanbanLaneWidth,
    "show-checkboxes": false,
    "archive-with-date": false
};

const kanbanEndText = `\n\n%% kanban:settings\n\`\`\`\n${JSON.stringify(kanbanSetting)}\n\`\`\`\n%%`;
const extrTexts = kanbanYaml + `## [[${fileName.replace(".md", "")}]]\n\n` + frameLinks.join("\n") + kanbanEndText;

if (KanbanPath) {
    app.vault.modify(KanbanPath, extrTexts);
} else {
    file = await app.vault.create(kanbanFilePath, extrTexts);
}

if (choice === choices[0]) {
    new Notice(`ğŸ–¼FrameKanbanå·²åˆ·æ–°`, 3000);
} else {
    new Notice(`â©FrameKanbanå·²åˆ·æ–°`, 3000);
}
return;

// æ’åº
async function processFile(allFrameEls, frameKanbanFullPath, fileName) {
    try {
        const data = await fs.promises.readFile(frameKanbanFullPath, 'utf8');
        const lines = data.split('\n');
        const updatedElements = [];

        const regex = new RegExp(`\\[\\[${fileName}\\#(\\^frame).*\\]\\]`);;
        let j = 0;
        for (let i = 0; i < lines.length; i++) {

            if (regex.test(lines[i])) {
                // åŒ¹é…å¯¹åº”çš„Excalidrawé“¾æ¥
                let regex = /^-\s.*?\[\[(.*?\.md)#\^(\w+)=([a-zA-Z0-9-_]+)\|?(.*?)\]\].*/;
                let elLinkStyle = lines[i].match(regex)[2];
                let elID = lines[i].match(regex)[3];
                let elText = lines[i].match(regex)[4] ? lines[i].match(regex)[4] : `æœªå®šä¹‰åç§°`;
                console.log(`ç¬¬${i}è¡Œï¼š${elID} ${elLinkStyle} ${elText}`);

                // æ»¡è¶³æ¡ä»¶çš„ä¿®æ”¹
                if (elLinkStyle !== 'frame') return;
                for (let selectedEl of allFrameEls) {
                    console.log(selectedEl.id);
                    if (selectedEl.id === elID) {
                        j = j + 1;
                        console.log(selectedEl.name);
                        elText = `Frame${j < 10 ? 0 : ""}${j}_${elText.replace(/Frame\d+_/, "")}`;
                        selectedEl.name = elText;
                        ea.addElementsToView();
                        lines[i] = lines[i].replace(/(^-\s.*?\[\[.*?\.md#\^\w+=[a-zA-Z0-9-_]+\|?)(.*?)(\]\].*)/, `$1${elText}$3`);
                    }
                }
            }
            updatedElements.push(lines[i]);
        }
        // console.log(updatedElements);
        return updatedElements;
    } catch (error) {
        new Notice("ğŸ”´è¯»å–æ–‡ä»¶å‡ºç°é”™è¯¯ï¼");
        console.error(error);
    }
}


```

## Log

> [!caution] æ ¹æ®ä¿®æ”¹æ—¥å¿—ï¼Œæ•™ç¨‹çš„éƒ¨åˆ†è¯´æ˜å¯èƒ½è¿‡æ—¶ï¼Œä½†åŸºæœ¬æ€è·¯æ˜¯ä¸€è‡´çš„ã€‚

### 2024-03-02ï¼šä¿®æ­£æ­£åˆ™è¡¨è¾¾å¼ï¼Œæ·»åŠ ç¼©ç•¥å›¾æ˜¯å¦æ·»åŠ è¿æ¥é€‰é¡¹ï¼Œä¿®æ”¹é€‰é¡¹ä¸ºä¸­æ–‡ï¼Œæ’åºåä¼šæ·»åŠ æ–‡æ¡£åˆ«åæ–¹ä¾¿æœç´¢

- ä¿®å¤ Sort æ’åºæ—¶æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ä¸åˆ°çš„é€‰é¡¹
- æ·»åŠ ç¼©ç•¥å›¾æ˜¯å¦æ·»åŠ è¿æ¥é€‰é¡¹ï¼Œå‚æ•°ä¿®æ”¹ä¸ºä¸­æ–‡æ³¨é‡Š
	- ![è‡ªå®šä¹‰Excalidrawè„šæœ¬-ç”»æ¿ä¸ Kanban å¾—æ¢¦å¹»ç»“åˆ-åƒPPTä¸€æ ·æ¼”ç¤º](https://cdn.pkmer.cn/images/202403021102094.png!pkmer)
- ä¿®æ”¹é€‰é¡¹ä¸ºä¸­æ–‡ï¼š
	- ![è‡ªå®šä¹‰Excalidrawè„šæœ¬-ç”»æ¿ä¸ Kanban å¾—æ¢¦å¹»ç»“åˆ-åƒPPTä¸€æ ·æ¼”ç¤º](https://cdn.pkmer.cn/images/202403021103678.png!pkmer)
- æ’åºåä¼šå°† Frame åç§°æ·»åŠ åˆ°æ–‡æ¡£çš„ aliases åŒº (æ·»åŠ æ–‡æ¡£åˆ«åæ–¹ä¾¿æœç´¢)
	-  ![è‡ªå®šä¹‰Excalidrawè„šæœ¬-ç”»æ¿ä¸ Kanban å¾—æ¢¦å¹»ç»“åˆ-åƒPPTä¸€æ ·æ¼”ç¤º](https://cdn.pkmer.cn/images/202403021332452.png!pkmer)