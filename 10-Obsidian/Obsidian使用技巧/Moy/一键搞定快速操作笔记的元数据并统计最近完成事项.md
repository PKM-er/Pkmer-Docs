---
uid: 20240730214933
title: ä¸€é”®æå®šå¿«é€Ÿæ“ä½œç¬”è®°çš„å…ƒæ•°æ®å¹¶ç»Ÿè®¡æœ€è¿‘å®Œæˆäº‹é¡¹
tags: [Obsidian, OBåˆ†äº«]
description: å¦‚ä½•åœ¨ Obsidian é‡Œä¸€é”®ç»™ç¬”è®°æ·»åŠ å®ŒæˆçŠ¶æ€å’Œå®Œæˆæ—¶é—´çš„æ•°æ®ï¼Œå¹¶ä¸”ç»Ÿè®¡å‡ºæœ€è¿‘ä¸€æ®µæ—¶é—´å®Œæˆçš„æ‰€æœ‰ç¬”è®°ï¼
author: Moy
type: other
draft: false
editable: false
modified: 20240806215523
aliases: []
---

# ä¸€é”®æå®šå¿«é€Ÿæ“ä½œç¬”è®°çš„å…ƒæ•°æ®å¹¶ç»Ÿè®¡æœ€è¿‘å®Œæˆäº‹é¡¹

è¯»è¿‡ PARA ç¬”è®°æ³•çš„æœ‹å‹ä»¬å¯èƒ½ä¼šåœ¨è‡ªå·±çš„ç¬”è®°ä¸­è®°å½• Projectï¼ˆå·¥ç¨‹ï¼‰ï¼Œå½“å®Œæˆä¸€é¡¹å·¥ç¨‹çš„æ—¶å€™ï¼Œå°±ä¼šæœ‰æ»¡æ»¡çš„æ”¶è·ï¼

ä½†åœ¨åˆšæ‰åˆä¸€æ¬¡ã€Œå®Œæˆã€äº†ä¸€æ¡ç¬”è®°çš„æ—¶å€™ï¼Œæˆ‘çªå‘å¥‡æƒ³â€”â€”

æ€ä¹ˆè®©è‡ªå·±çš„ç‚¹æ»´æ¶“æµæ±‡èšæˆæ²³å‘¢ï¼Ÿ

å…ƒæ•°æ®ã€‚

åœ¨ç¬”è®°å±æ€§ä¸­æ·»åŠ  `done` å±æ€§ï¼Œä»£è¡¨è¿™æ˜¯ä¸€ä¸ª **å®Œæˆäº†çš„é¡¹ç›®**ï¼›

å†æ·»åŠ ä¸€ä¸ª `finished_date`ï¼Œè®°å½• **å®Œæˆæ—¶é—´**ã€‚

è¿™æ ·ä¸€æ¥ï¼Œå¯ä»¥å€ŸåŠ© Dataview éå¸¸æ–¹ä¾¿åœ°ç»Ÿè®¡å’Œå›é¡¾â€”â€”è‡ªå·±è¿™æ®µæ—¶é—´å®Œæˆäº†å¤šå°‘é¡¹ç›®ã€‚

## æ·»åŠ å…ƒæ•°æ®

æ·»åŠ å±æ€§æœ€ç®€å•ä½†æ˜¯éº»çƒ¦çš„æ–¹å¼ï¼Œå°±æ˜¯æ‰‹åŠ¨ç‚¹å‡»ã€Œæ·»åŠ æ–‡æ¡£å±æ€§ã€ï¼Œç„¶ååŠ ä¸Š `å¤é€‰æ¡†` ç±»å‹çš„ done å±æ€§ï¼Œä»¥åŠ `æ—¥æœŸ` ç±»å‹çš„ finished_date å±æ€§ã€‚

![](https://cdn.pkmer.cn/images/202408062154273.png!pkmer)

ç„¶ååœ¨åšå®Œé¡¹ç›®çš„æ—¶å€™ï¼Œæ‰‹åŠ¨æ‰“å‹¾å¹¶å¡«å†™æ—¥æœŸã€‚

è¿™æ ·å¤ªéº»çƒ¦äº†â€¦â€¦æˆ‘ä»¬ OB ç”¨æˆ·ä¸èƒ½å¿å—è¿™ç§éº»çƒ¦çš„ã€‚

![ä¸ä¸­](https://cdn.pkmer.cn/images/202408062154580.png!pkmer)

æ‰€ä»¥æˆ‘ç”¨ Templater æ’ä»¶å†™äº†ä¸ªè„šæœ¬ï¼Œå¯ä»¥ **ä¸€é”®æ·»åŠ å®ŒæˆçŠ¶æ€**ã€‚

è„šæœ¬å¦‚ä¸‹ï¼š

```js
<%*
/*
- Author: Moy
- Create Time: 2024-07-30
- Description: è¿™æ˜¯ä¸€ä¸ªç”¨æ¥ä¿®æ”¹å½“å‰æ–‡ä»¶çš„å…ƒæ•°æ®çš„èŒƒä¾‹è„šæœ¬
- Version: 1.0
*/

// é…ç½®é¡¹

// ä¸¤ä¸ªå…ƒæ•°æ®çš„å±æ€§åï¼Œä¸€ä¸ªæ˜¯ bool ç±»å‹ï¼ˆæ‰“å‹¾ï¼‰ï¼Œå¦ä¸€ä¸ªæ˜¯æ—¥æœŸç±»å‹
const propDone = "done";
const propFinishedDay  = "finished_date";
// è¿™é‡Œå¡«å†™æ—¥è®°çš„æ ¼å¼
const dateFormat = "YYYY-MM-DD";

const todayDate = moment().format(dateFormat);

// ç¬¬ä¸€ç§è·å¾—ç¬”è®°çš„æ–¹æ³•ï¼ŒæŒ‰ç…§è·¯å¾„åŒ¹é…ï¼Œåº”è¯¥ä¼šæ›´å‡†ç¡®ä¸€äº›
const notePath = tp.file.path(true);  // è¿™é‡Œè¦ä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼Œå¦åˆ™ä¸‹é¢çš„å‡½æ•°è¯»å–ä¸åˆ°çš„
const fileObj = app.vault.getAbstractFileByPath(notePath);

// ç¬¬äºŒç§æ–¹æ³•ï¼Œç”¨ç¬”è®°ååŒ¹é…
const noteName = tp.file.title;
// const fileObj = tp.file.find_tfile(noteName);

function updateFM( fm ) {
	fm[propDone] = true;
	fm[propFinishedDay] = todayDate;
	new Notice(`ä½ åœ¨ ${todayDate} å®Œæˆäº†ï¼š\n${noteName}\næ­å–œï¼ ğŸ‰`);
}

if (fileObj) {
    app.fileManager.processFrontMatter(fileObj, (fm) => {
        if (fm[propDone]) {
            tp.system.prompt("å·²å­˜åœ¨ Done å±æ€§ï¼Œæ˜¯å¦åˆ·æ–°å®Œæˆæ—¥æœŸï¼Ÿ", "æ˜¯")
                .then((confirm) => {
                    if (confirm == "æ˜¯") {
                        updateFM(fm);
                    } else {
	                    new Notice("å–æ¶ˆæ›´æ–°å®Œæˆæ—¶é—´");
                    }
                });
        } else {
            updateFM(fm);
        }
    });
}
%>
```

åç»­å¦‚æœæœ‰æ›´æ–°ä¼šæ”¾åœ¨ï¼š[TP Script: Add done and finished date into Frontmatter (Property)](https://gist.github.com/Moyf/b14c3374b49ce53e1be7ca939ced611e)

è¿™ä¸ªè„šæœ¬å°±æ˜¯ä¸ªæ¨¡æ¿ï¼ŒæŒ‰ç…§ TP é€šå¸¸æ¨¡æ¿çš„æ–¹å¼è°ƒç”¨å³å¯ã€‚

æ•ˆæœæ¼”ç¤ºï¼š

![](https://cdn.pkmer.cn/images/202408062154672.gif!pkmer)

## ç»Ÿè®¡

ä½¿ç”¨ Dataview ä¸ä½†èƒ½åˆ—å‡ºæ‰€æœ‰ã€Œå®Œæˆäº†çš„ç¬”è®°ã€ï¼Œè¿˜èƒ½è®¡ç®—å‡ºè¿™ä¸ªé¡¹ç›®ä»åˆ›å»ºåˆ°å®Œæˆä¸€å…±ç²¾åŠ›äº†å¤šå°‘å¤©ï¼Œå¹¶æŒ‰ç…§æ—¶é—´å…ˆåè¿›è¡Œæ’åºã€‚

æ•ˆæœï¼š

![](https://cdn.pkmer.cn/images/202408062154978.jpg!pkmer)

ä½¿ç”¨çš„ Dataview ä»£ç ï¼š

```
TABLE
dateformat(date(file.frontmatter["create_date"]), "yyyy-MM-dd") AS åˆ›å»ºæ—¶é—´,
file.frontmatter["finished_date"] AS å®Œæˆæ—¶é—´,
choice(file.frontmatter["finished_date"], round((date(file.frontmatter["finished_date"]) - striptime(date(file.frontmatter["create_date"]))).days) + " å¤©", "æ— æ•°æ®") AS å†ç»

FROM ""
WHERE done AND finished_date

SORT file.frontmatter["finished_date"] DESC
```

- è¿™é‡Œçš„ `create_date` æ”¹æˆä½ è‡ªå·±çš„ã€Œåˆ›å»ºæ—¶é—´ã€å±æ€§åï¼Œå¦‚æœæ²¡æœ‰çš„è¯ï¼Œå¯ä»¥æŠŠ `date(file.frontmatter["create_date"])` æ›¿æ¢æˆ `cday`ï¼Œè¿™ä¼šä½¿ç”¨æ–‡æœ¬æœ¬èº«çš„åˆ›å»ºæ—¥æœŸ
- åŒæ ·çš„ï¼Œ`done` å’Œ ` finished_date ` æ¢æˆä½ è‡ªå·±çš„ã€Œå®ŒæˆçŠ¶æ€ã€ã€ã€Œå®Œæˆæ—¶é—´ã€å±æ€§å

